<div class="antialiased sans-serif bg-gray-50 min-h-screen p-6">
  <!-- En-tête avec compteur -->
  <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
    <h2 class="text-2xl font-bold bg-gradient-to-r from-[#D45C00] to-black bg-clip-text text-transparent">
      Liste des personnes à importer
    </h2>
    <div
      class="bg-[#D45C00] bg-opacity-10 text-[#D45C00] px-4 py-2 rounded-lg text-sm font-medium border border-[#D45C00] border-opacity-20">
      Total : <span class="font-bold">{{dataExcel.length}}</span> {{dataExcel.length > 1 ? 'éléments' : 'élément'}}
    </div>
  </div>

  <div *ngIf="hasErrors()" class="mb-4 p-4 bg-red-50 border-l-4 border-red-500 text-red-700">
    <h3 class="font-bold">Erreurs de validation :</h3>
    <ul class="list-disc pl-5 mt-2">
      <li *ngFor="let error of getErrorMessages()">{{ error }}</li>
    </ul>
  </div>

  <!-- Tableau -->
  <div class="bg-white rounded-lg shadow-sm overflow-hidden border border-gray-200">
    <div class="overflow-x-auto overflow-y-auto relative" style="max-height: 80vh; min-height: 300px;">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th *ngFor="let heading of headings"
              class="px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider sticky top-0 bg-gray-50 z-10 border-b border-gray-200">
              <div class="flex items-center gap-2">
                {{ heading }}
                <svg class="w-3 h-3 text-[#D45C00] opacity-70" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"></path>
                </svg>
              </div>
            </th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          <tr *ngFor="let user of dataExcel" class="hover:bg-gray-50 transition-colors duration-150">
            <td *ngFor="let heading of headings" class="px-6 py-4">
              <div class="flex items-center text-sm text-gray-800">
                <span class="truncate max-w-xs" [title]="user[heading]">
                  {{ user[heading] || '-' }}
                </span>
              </div>
            </td>
          </tr>
          <tr *ngIf="dataExcel.length === 0">
            <td [attr.colspan]="headings.length" class="px-6 py-12 text-center">
              <div class="flex flex-col items-center justify-center">
                <svg class="w-12 h-12 mb-4 text-[#D45C00]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                    d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <span class="text-lg font-medium text-black">Aucune donnée disponible</span>
                <span class="text-sm mt-1 text-gray-500">Ajoutez des données pour les voir apparaître ici</span>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
