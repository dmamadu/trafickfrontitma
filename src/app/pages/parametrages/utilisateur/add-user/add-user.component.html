
<mat-toolbar class="mat-accent m-0 backToolbar">
  <mat-toolbar-row fxFlex fxLayout="row" fxLayoutAlign="space-between center" class="c_formulaire">
    <span class="c_title dialog-title">{{ dialogTitle }}</span>
    <button mat-icon-button (click)="matDialogRef.close()" aria-label="Close dialog" class="closeButton">
      <mat-icon>close</mat-icon>
    </button>
  </mat-toolbar-row>
</mat-toolbar>



   <!-- Image Section -->
   <div class="row">
    <div class="col-lg-12 text-center mb-4">
      <div class="position-relative d-inline-block">
        <div class="position-absolute bottom-0 end-0">
          <label for="member-image-input" class="mb-0" data-bs-toggle="tooltip" data-bs-placement="right"
            title="Select Member Image">
            <div class="avatar-xs">
              <div class="avatar-title bg-light border rounded-circle text-muted cursor-pointer">
                <i class="bx bxs-image-alt"></i>
              </div>
            </div>
          </label>
          <input class="form-control d-none" id="member-image-input" type="file"
            accept="image/png, image/gif, image/jpeg" (change)="selectOnFile($event,'photo_profile','Thumbnail')">
          <!-- Bouton pour supprimer l'image -->
          @if (uploadedImage) {
          <div>
            <button type="button" class="btn btn-danger btn-sm mt-1" id="delete-image-btn"
              (click)="deleteImage()">
              <i class="bx bx-trash me-1"></i>
            </button>
          </div>
          }


        </div>
        <div class="avatar-lg">
          <div class="avatar-title bg-light rounded-circle">
            <img [src]="imageToff ? imageToff : 'assets/images/users/user-dummy-img.jpg'"
                 class="avatar-md rounded-circle h-auto limited-image" />
        </div>
        </div>
      </div>
    </div>
  </div>


  <!-- Form Fields Section -->



<div class="flex flex-col flex-auto min-w-10-0 p-2 md:p-4">
  <form [formGroup]="initForm" class="event-form w-100-p">
    <div class="flex gap-2">
      <mat-form-field class="w-1/2 mt-2" appearance="outline">
        <mat-label class="enteteccColor">Nom
        </mat-label>
        <input class="typeTitle" matInput type="text" name="lastname" formControlName="lastname" />
        <mat-icon matSuffix class="secondary-text">code</mat-icon>
        <mat-error>Le champs est obligatoire</mat-error>
      </mat-form-field>

      <mat-form-field class=" w-1/2 mt-2" appearance="outline">
        <mat-label class="enteteccColor">Prénom
        </mat-label>
        <input class="typeTitle" matInput type="text" name="firstname" formControlName="firstname" />
        <mat-icon matSuffix class="secondary-text">code</mat-icon>
        <mat-error>Le champs est obligatoire</mat-error>
      </mat-form-field>
    </div>
    <div class="flex gap-2">
      <mat-form-field class=" w-1/2 mt-2"  appearance="outline">
        <mat-label disabled value="" selected class="enteteccColor">Email</mat-label>
        <input class="typeTitle" matInput type="email" name="email" formControlName="email" />
        <mat-icon matSuffix class="secondary-text">email</mat-icon>
        <mat-error>Le champs est oligatoire</mat-error>
      </mat-form-field>
      <!-- <mat-form-field class=" w-1/2 mt-2" fxFlex="100" appearance="outline">
        <mat-label disabled value="" selected class="enteteccColor">Adresse</mat-label>
        <input class="typeTitle" matInput type="text" name="locality" formControlName="locality" />
        <mat-icon matSuffix class="secondary-text">home</mat-icon>
        <mat-error>Le champs est oligatoire</mat-error>
      </mat-form-field> -->
      <mat-form-field  class=" w-1/2 mt-2 telephone" appearance="outline">
        <ngx-mat-intl-tel-input [preferredCountries]="['sn', 'fr']" [enablePlaceholder]="true" [enableSearch]="true"
          name="contact" describedBy="Téléphone WhatsApp"
          formControlName="contact"></ngx-mat-intl-tel-input>
          <mat-icon matSuffix class="secondary-text">phone</mat-icon>
        <mat-error>Le champs est obligatoire</mat-error>
      </mat-form-field>
    </div>

    <div class="flex gap-2">
      <mat-form-field class="w-1/2 mt-2" appearance="outline">
        <mat-label class="enteteccColor">Role</mat-label>
        <mat-select formControlName="role_id">
          <mat-option *ngFor="let role of roles" [value]="role.id">
            {{ role.name }}
          </mat-option>
        </mat-select>
        <mat-icon matSuffix class="secondary-text">code</mat-icon>
        <mat-error>Le champs est obligatoire</mat-error>
      </mat-form-field>
      <mat-form-field class="w-1/2 mt-2" appearance="outline">
        <mat-label class="enteteccColor">Niveau</mat-label>
        <mat-select formControlName="categorie_id" (selectionChange)="onCategoryChange($event.value)">
          <mat-option *ngFor="let categorie of categories" [value]="categorie.id">
            {{ categorie.libelle }}
          </mat-option>
        </mat-select>
        <mat-icon matSuffix class="secondary-text">code</mat-icon>
        <mat-error>Le champs est obligatoire</mat-error>
      </mat-form-field>

    </div>
    <div class="flex gap-2">
      <mat-form-field class="w-full mt-2" appearance="outline" >
        <mat-label class="enteteccColor">Fonctions</mat-label>
        <mat-select formControlName="fonction_id" *ngIf="action=='new'">
          <mat-option *ngFor="let profil of filteredProfils" [value]="profil.id" >
            {{ profil.libelle }}
          </mat-option>
        </mat-select>

        <mat-select formControlName="fonction_id" *ngIf="action=='edit'">
          <mat-option *ngFor="let profil of profils" [value]="profil.id" >
            {{ profil.libelle }}
          </mat-option>
        </mat-select>
        <mat-icon matSuffix class="secondary-text">code</mat-icon>
        <mat-error>Le champs est obligatoire</mat-error>
      </mat-form-field>
    </div>

    <div class="flex justify-center gap-4">
      <button mat-raised-button class="submit-buttonRed" type="button">
        <span class="textForm">Retour</span>
      </button>&nbsp;
      <button [disabled]="loader" mat-raised-button class="submit-button" (click)="checkRecap(action)">
        <span class="textForm">{{ labelButton }}</span>
      </button>
    </div>
  </form>
  <app-loader-data *ngIf="loader"></app-loader-data>
</div>
