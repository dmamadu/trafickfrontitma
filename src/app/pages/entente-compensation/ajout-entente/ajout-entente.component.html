<mat-toolbar class="mat-accent m-0 backToolbar">
  <mat-toolbar-row fxFlex fxLayout="row" fxLayoutAlign="space-between center" class="c_formulaire">
    <span class="">Ajouter une entente de compensation</span>
    <button mat-icon-button (click)="matDialogRef.close()" aria-label="Close dialog" class="closeButton">
      <mat-icon>close</mat-icon>
    </button>
  </mat-toolbar-row>
</mat-toolbar>













<mat-stepper #stepper>
  <form [formGroup]="initForm" class="event-form w-100-p">

    <mat-step label="Informations personnelles">
      <div class="flex gap-2">
        <mat-form-field class="w-1/2 mt-2" appearance="outline">
          <mat-label class="enteteccColor">Code Pap
          </mat-label>
          <input class="typeTitle" matInput type="text" name="codePap" formControlName="codePap" />
          <mat-error>Le champs est obligatoire</mat-error>
          <mat-icon matSuffix class="secondary-text">code</mat-icon>
        </mat-form-field>
        <mat-form-field class=" w-1/2 mt-2" appearance="outline">
          <mat-label class="enteteccColor">Categorie du Pap
          </mat-label>
          <input class="typeTitle" matInput type="number" name="categoriePap" formControlName="categoriePap" />
          <mat-icon matSuffix class="secondary-text">code</mat-icon>
          <mat-error>Le champs est obligatoire</mat-error>
        </mat-form-field>
      </div>
      <div class="d-flex justify-center">
        <button mat-raised-button class="submit-button" aria-label="VALIDER" type="button" (click)="cherchePap()">
          <span class="textForm">Rechercher le pap</span>
        </button>
      </div>

      <div class="flex gap-2">
        <mat-form-field class="w-1/2 mt-2" appearance="outline">
          <mat-label class="enteteccColor">Prénom
          </mat-label>
          <input class="typeTitle" matInput type="text" name="prenom" formControlName="prenom" />
          <mat-error>Le champs est obligatoire</mat-error>
          <mat-icon matSuffix class="secondary-text">code</mat-icon>
        </mat-form-field>

        <mat-form-field class=" w-1/2 mt-2" appearance="outline">
          <mat-label class="enteteccColor">Nom
          </mat-label>
          <input class="typeTitle" matInput type="text" name="nom" formControlName="nom" />
          <mat-icon matSuffix class="secondary-text">code</mat-icon>
          <mat-error>Le champs est obligatoire</mat-error>
        </mat-form-field>
      </div>

      <div class="flex gap-2">
        <mat-form-field class=" w-full mt-2" fxFlex="50" appearance="outline">
          <mat-label disabled value="" selected class="enteteccColor">Nature de la pièce</mat-label>

          <input class="typeTitle" matInput type="text" name="typeIdentification"
            formControlName="typeIdentification" />
          <mat-icon matSuffix class="enteteccColor">storage</mat-icon>
          <mat-error>Le champs est obligatoire</mat-error>
        </mat-form-field>
        <mat-form-field class=" w-1/2 mt-2" appearance="outline">
          <mat-label class="enteteccColor">Numéro de pièce
          </mat-label>
          <input matInput type="text" name="numeroIdentification" formControlName="numeroIdentification" />
          <mat-icon matSuffix class="secondary-text">dialpad</mat-icon>
          <mat-error
            *ngIf="initForm.get('numeroIdentification')?.touched && initForm.get('numeroIdentification')?.errors?.required">ce
            champs est requis</mat-error>
        </mat-form-field>
      </div>

      <div class="flex gap-2">
        <mat-form-field class="w-1/2 mt-2" fxFlex="50" appearance="outline">
          <mat-label class="enteteccColor">Nationnalité</mat-label>
          <input class="enteteccColor" matInput type="text" formControlName="nationalite" />
          <mat-error>Le champs est oligatoire</mat-error>
        </mat-form-field>

        <mat-form-field class=" w-1/2 mt-2" appearance="outline">
          <mat-label class="enteteccColor">Sexe
          </mat-label>
          <input class="typeTitle" matInput type="text" name="sexe" formControlName="sexe" />
          <mat-icon matSuffix class="secondary-text">place</mat-icon>
          <mat-error>Le champs est obligatoire</mat-error>
        </mat-form-field>
      </div>
      <div class="flex gap-2">
        <mat-form-field class=" w-full mt-2" fxFlex="50" appearance="outline">
          <mat-label disabled value="" selected class="enteteccColor">Département</mat-label>
          <input class="typeTitle" matInput type="text" name="departement" formControlName="departement" />
          <mat-icon matSuffix class="enteteccColor">storage</mat-icon>
          <mat-error>Le champs est obligatoire</mat-error>
        </mat-form-field>
        <mat-form-field class=" w-1/2 mt-2" appearance="outline">
          <mat-label class="enteteccColor">Commune
          </mat-label>
          <input matInput type="text" name="commune" formControlName="commune" />
          <mat-icon matSuffix class="secondary-text">dialpad</mat-icon>
          <mat-error *ngIf="initForm.get('commune')?.touched && initForm.get('commune')?.errors?.required">ce
            champs est requis</mat-error>
        </mat-form-field>
      </div>
      <div class="flex justify-center gap-4">
        <button mat-raised-button class="submit-buttonRed" matStepperPrevious type="button">
          <span class="textForm">Retour</span>
        </button>&nbsp;
        <button matStepperNext mat-raised-button class="submit-button">
          <span class="textForm">Suivant</span>
        </button>
      </div>
    </mat-step>
    <mat-step label="Frais/équipements">
      <div *ngIf="typePap!=='papEconomique'">
        <div class="inner-repeater mb-2">
          <div class="inner mb-0 row">
            <div class="flex gap-2">
              <mat-form-field class="w-1/2 mt-2" fxFlex="50" appearance="outline">
                <mat-label class="enteteccColor">Frais de déplacement </mat-label>
                <input class="enteteccColor" matInput type="text" formControlName="fraisDeplacement" />
                <mat-error>Le champs est oligatoire</mat-error>
              </mat-form-field>
              <mat-form-field class=" w-1/2 mt-2" appearance="outline">
                <mat-label class="enteteccColor">Appuie à la relocalisation
                </mat-label>
                <input class="typeTitle" matInput type="text" name="appuiRelocalisation"
                  formControlName="appuiRelocalisation" />
                <mat-icon matSuffix class="secondary-text">place</mat-icon>
                <mat-error>Le champs est obligatoire</mat-error>
              </mat-form-field>
            </div>
            <div class="flex gap-2">
              <mat-form-field class="w-full mt-2" appearance="outline">
                <mat-label class="enteteccColor">Frais Total déplacement
                </mat-label>
                <input class="typeTitle" matInput type="text" name="fraisTotalDeplacement"
                  formControlName="fraisTotalDeplacement" />
                <mat-error>Le champs est obligatoire</mat-error>
                <mat-icon matSuffix class="secondary-text">code</mat-icon>
              </mat-form-field>
            </div>
            <div>
              <label for="">Pertes d’équipements</label>
            </div>
            <div class="flex gap-2">
              <mat-form-field class="w-1/2 mt-2" appearance="outline">
                <mat-label class="enteteccColor">Nombre d'équipements
                </mat-label>
                <input class="typeTitle" matInput type="text" name="nbArbreEquipement"
                  formControlName="nbArbreEquipement" />
                <mat-error>Le champs est obligatoire</mat-error>
                <mat-icon matSuffix class="secondary-text">code</mat-icon>
              </mat-form-field>
              <mat-form-field class=" w-1/2 mt-2" appearance="outline">
                <mat-label class="enteteccColor">Prix d'équipement
                </mat-label>
                <input class="typeTitle" matInput type="number" name="prixArbreEquipement"
                  formControlName="prixArbreEquipement" />
                <mat-icon matSuffix class="secondary-text">code</mat-icon>
                <mat-error>Le champs est obligatoire</mat-error>
              </mat-form-field>
            </div>

            <div class="flex gap-2">
              <mat-form-field class="w-full mt-2" appearance="outline">
                <mat-label class="enteteccColor">Perte totale des equipements
                </mat-label>
                <input class="typeTitle" matInput type="text" name="perteEquipement"
                  formControlName="perteEquipement" />
                <mat-error>Le champs est obligatoire</mat-error>
                <mat-icon matSuffix class="secondary-text">code</mat-icon>
              </mat-form-field>
            </div>
            <div>
              <label for="">Pertes de revenues</label>
            </div>
            <div class="flex gap-2">
              <mat-form-field class="w-1/2 mt-2" appearance="outline">
                <mat-label class="enteteccColor">Catégorie
                </mat-label>
                <input class="typeTitle" matInput type="text" name="categorieRevenue"
                  formControlName="categorieRevenue" />
                <mat-error>Le champs est obligatoire</mat-error>
                <mat-icon matSuffix class="secondary-text">code</mat-icon>
              </mat-form-field>
              <mat-form-field class=" w-1/2 mt-2" appearance="outline">
                <mat-label class="enteteccColor">Bareme
                </mat-label>
                <input class="typeTitle" matInput type="number" name="baremeRevenue" formControlName="baremeRevenue" />
                <mat-icon matSuffix class="secondary-text">code</mat-icon>
                <mat-error>Le champs est obligatoire</mat-error>
              </mat-form-field>
            </div>
            <div class="flex gap-2">
              <mat-form-field class="w-full mt-2" appearance="outline">
                <mat-label class="enteteccColor">Perte totale des revenues
                </mat-label>
                <input class="typeTitle" matInput type="text" name="perteRevenue" formControlName="perteRevenue" />
                <mat-error>Le champs est obligatoire</mat-error>
                <mat-icon matSuffix class="secondary-text">code</mat-icon>
              </mat-form-field>
            </div>
          </div>
        </div>
      </div>


      <!--papAgricole-->


      <div *ngIf="typePap=='papEconomique'">
        <div class="inner-repeater mb-2">
          <div class="inner mb-0 row">
            <div>
              <label for="">Pertes de terres</label>
            </div>
            <div class="flex gap-2">
              <mat-form-field class="w-1/2 mt-2" appearance="outline">
                <mat-label class="enteteccColor">Superificie affecteé
                </mat-label>
                <input class="typeTitle" matInput type="text" name="superficieAffecte"
                  formControlName="superficieAffecte" />
                <mat-error>Le champs est obligatoire</mat-error>
                <mat-icon matSuffix class="secondary-text">code</mat-icon>
              </mat-form-field>
              <mat-form-field class=" w-1/2 mt-2" appearance="outline">
                <mat-label class="enteteccColor">Bareme au mettre carré
                </mat-label>
                <input class="typeTitle" matInput type="number" name="baremeTypeSol" formControlName="baremeTypeSol" />
                <mat-icon matSuffix class="secondary-text">code</mat-icon>
                <mat-error>Le champs est obligatoire</mat-error>
              </mat-form-field>
            </div>

            <div class="flex gap-2">
              <mat-form-field class="w-full mt-2" appearance="outline">
                <mat-label class="enteteccColor">Perte totale des terres
                </mat-label>
                <input class="typeTitle" matInput type="text" name="perteTerre" formControlName="perteTerre" />
                <mat-error>Le champs est obligatoire</mat-error>
                <mat-icon matSuffix class="secondary-text">code</mat-icon>
              </mat-form-field>
            </div>
            <div>
              <label for="">Pertes d’équipements</label>
            </div>
            <div class="flex gap-2">
              <mat-form-field class="w-1/2 mt-2" appearance="outline">
                <mat-label class="enteteccColor">Nombre d'équipements
                </mat-label>
                <input class="typeTitle" matInput type="text" name="nbArbreEquipement"
                  formControlName="nbArbreEquipement" />
                <mat-error>Le champs est obligatoire</mat-error>
                <mat-icon matSuffix class="secondary-text">code</mat-icon>
              </mat-form-field>
              <mat-form-field class=" w-1/2 mt-2" appearance="outline">
                <mat-label class="enteteccColor">Prix d'équipement
                </mat-label>
                <input class="typeTitle" matInput type="number" name="prixArbreEquipement"
                  formControlName="prixArbreEquipement" />
                <mat-icon matSuffix class="secondary-text">code</mat-icon>
                <mat-error>Le champs est obligatoire</mat-error>
              </mat-form-field>
            </div>

            <div class="flex gap-2">
              <mat-form-field class="w-full mt-2" appearance="outline">
                <mat-label class="enteteccColor">Perte totale des equipements
                </mat-label>
                <input class="typeTitle" matInput type="text" name="perteEquipement"
                  formControlName="perteEquipement" />
                <mat-error>Le champs est obligatoire</mat-error>
                <mat-icon matSuffix class="secondary-text">code</mat-icon>
              </mat-form-field>
            </div>



          </div>
        </div>
      </div>



      <!--FinpapAgricole-->

      <div class="flex justify-center gap-4">
        <button mat-raised-button class="submit-buttonRed" matStepperPrevious type="button">
          <span class="textForm">Retour</span>
        </button>&nbsp;
        <button matStepperNext mat-raised-button class="submit-button">
          <span class="textForm">Suivant</span>
        </button>
      </div>
    </mat-step>


    <mat-step label="Pertes de recoltes">
      <div>
        <label for="">Pertes de recoltes</label>
      </div>
      <div class="flex gap-2">
        <mat-form-field class="w-1/3 mt-2" appearance="outline">
          <mat-label class="enteteccColor">Rendement spéculation
          </mat-label>
          <input class="typeTitle" matInput type="text" name="rendement" formControlName="rendement" />
          <mat-error>Le champs est obligatoire</mat-error>
          <mat-icon matSuffix class="secondary-text">code</mat-icon>
        </mat-form-field>
        <mat-form-field class=" w-1/3 mt-2" appearance="outline">
          <mat-label class="enteteccColor">Superficie Cultivée
          </mat-label>
          <input class="typeTitle" matInput type="number" name="superficieCultive"
            formControlName="superficieCultive" />
          <mat-icon matSuffix class="secondary-text">code</mat-icon>
          <mat-error>Le champs est obligatoire</mat-error>
        </mat-form-field>

        <mat-form-field class=" w-1/3 mt-2" appearance="outline">
          <mat-label class="enteteccColor">Prix au mettre carré
          </mat-label>
          <input class="typeTitle" matInput type="number" name="prixMettreCarre"
            formControlName="prixMettreCarre" />
          <mat-icon matSuffix class="secondary-text">code</mat-icon>
          <mat-error>Le champs est obligatoire</mat-error>
        </mat-form-field>
      </div>

      <div class="flex gap-2">
        <mat-form-field class="w-full mt-2" appearance="outline">
          <mat-label class="enteteccColor">Perte totale des recoltes
          </mat-label>
          <input class="typeTitle" matInput type="text" name="perteRecolte" formControlName="perteRecolte" />
          <mat-error>Le champs est obligatoire</mat-error>
          <mat-icon matSuffix class="secondary-text">code</mat-icon>
        </mat-form-field>
      </div>


      <div class="flex justify-center gap-4">
        <button mat-raised-button class="submit-buttonRed" matStepperPrevious type="button">
          <span class="textForm">Retour</span>
        </button>&nbsp;
        <button matStepperNext mat-raised-button class="submit-button">
          <span class="textForm">Suivant</span>
        </button>
      </div>
    </mat-step>


    <mat-step label="Pertes d'arbres">
      <div class="inner-repeater mb-4">
        <div class="inner mb-0 row">
          <div>
            <label for="">Perte d'arbres jeunes</label>
          </div>
          <div class="flex gap-2">
            <mat-form-field class="w-1/2 mt-2" appearance="outline">
              <mat-label class="enteteccColor">Nombre d’arbres
              </mat-label>
              <input class="typeTitle" matInput type="text" name="nbArbreJeune" formControlName="nbArbreJeune" />
              <mat-error>Le champs est obligatoire</mat-error>
              <mat-icon matSuffix class="secondary-text">code</mat-icon>
            </mat-form-field>
            <mat-form-field class=" w-1/2 mt-2" appearance="outline">
              <mat-label class="enteteccColor">Prix d'arbre
              </mat-label>
              <input class="typeTitle" matInput type="number" name="prixArbreJeune" formControlName="prixArbreJeune" />
              <mat-icon matSuffix class="secondary-text">code</mat-icon>
              <mat-error>Le champs est obligatoire</mat-error>
            </mat-form-field>
          </div>
          <div class="flex gap-2">
            <mat-form-field class="w-full mt-2" appearance="outline">
              <mat-label class="enteteccColor">Perte totale arbre jeune
              </mat-label>
              <input class="typeTitle" matInput type="text" name="perteArbreJeune" formControlName="perteArbreJeune" />
              <mat-error>Le champs est obligatoire</mat-error>
              <mat-icon matSuffix class="secondary-text">code</mat-icon>
            </mat-form-field>
          </div>

          <div>
            <label for="">Pertes d'arbres adultes</label>
          </div>
          <div class="flex gap-2">
            <mat-form-field class="w-1/2 mt-2" appearance="outline">
              <mat-label class="enteteccColor">Nombre d’arbres
              </mat-label>
              <input class="typeTitle" matInput type="text" name="nbArbreAdulte" formControlName="nbArbreAdulte" />
              <mat-error>Le champs est obligatoire</mat-error>
              <mat-icon matSuffix class="secondary-text">code</mat-icon>
            </mat-form-field>
            <mat-form-field class=" w-1/2 mt-2" appearance="outline">
              <mat-label class="enteteccColor">Prix d'arbre
              </mat-label>
              <input class="typeTitle" matInput type="number" name="prixArbreAdulte"
                formControlName="prixArbreAdulte" />
              <mat-icon matSuffix class="secondary-text">code</mat-icon>
              <mat-error>Le champs est obligatoire</mat-error>
            </mat-form-field>
          </div>
          <div class="flex gap-2">
            <mat-form-field class="w-full mt-2" appearance="outline">
              <mat-label class="enteteccColor">Perte totale arbre adulte
              </mat-label>
              <input class="typeTitle" matInput type="text" name="perteArbreAdulte"
                formControlName="perteArbreAdulte" />
              <mat-error>Le champs est obligatoire</mat-error>
              <mat-icon matSuffix class="secondary-text">code</mat-icon>
            </mat-form-field>
          </div>
        </div>
      </div>

      <div class="flex justify-center gap-4">
        <button mat-raised-button class="submit-buttonRed" matStepperPrevious type="button">
          <span class="textForm">Retour</span>
        </button>&nbsp;
        <button matStepperNext mat-raised-button class="submit-button">
          <span class="textForm">Suivant</span>
        </button>
      </div>
    </mat-step>

    <mat-step label="Signatures">
      <div class="flex gap-2">
        <mat-form-field class="w-full mt-2" appearance="outline">
          <mat-label class="enteteccColor">Perte totales
          </mat-label>
          <input class="typeTitle" matInput type="text" name="perteTotale" formControlName="perteTotale" />
          <mat-error>Le champs est obligatoire</mat-error>
          <mat-icon matSuffix class="secondary-text">code</mat-icon>
        </mat-form-field>
      </div>
      <div class="flex items-center justify-center my-5">
        <div class="w-1/2 mt-2">
          <label for="">Signature du pap</label>
          <img class="w-32 h-32" [src]="initForm.get('urlSignaturePap')?.value" alt=""
            *ngIf="initForm.get('urlSignaturePap')?.value">
          <div class="flex items-center mt-6 lg:mt-0 space-x-6">
            <div class="flex flex-col">
              <input matInput type="text" name="numeroIdentification" formControlName="urlSignaturePap" hidden />
              <button (click)="signatureClient('urlSignaturePap')"
                class="c_btnAccount_attribut c_btnAccountF h-10 w-10 rounded-full"
                matTooltip="Ajouter signature du Pap">
                <i class="bx bx-pencil"></i>
              </button>
            </div>
          </div>
        </div>
        <div class="w-1/2 mt-2">
          <label for="">Signature du responsable</label>
          <img class="w-32 h-32" [src]="initForm.get('urlSignatureResponsable')?.value" alt=""
            *ngIf="initForm.get('urlSignatureResponsable')?.value">
          <div class="flex items-center mt-6 lg:mt-0 space-x-6">
            <div class="flex flex-col">
              <input matInput type="text" name="numeroIdentification" formControlName="urlSignatureResponsable"
                hidden />
              <button (click)="signatureClient('urlSignatureResponsable')"
                class="c_btnAccount_attribut c_btnAccountF h-10 w-10 rounded-full"
                matTooltip="Ajouter signature du Responsable">
                <i class="bx bx-pencil"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
      <div class="flex justify-center gap-4">
        <button mat-raised-button class="submit-buttonRed" matStepperPrevious type="button">
          <span class="textForm">Retour</span>
        </button>&nbsp;
        <button matStepperNext mat-raised-button class="submit-button">
          <span class="textForm">Suivant</span>
        </button>
      </div>
    </mat-step>

    <mat-step label="Récapitulatif">

      <div class="p-4">
        <h3 class="recap-title">Signatures</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div class="flex flex-col items-center">
            <div class="flex space-x-4">
              <div>
                <label for="">Signature du Pap</label>
                <img [src]="initForm.get('urlSignaturePap')?.value" alt="" class="w-1/2 h-auto">
              </div>
              <div>
                <label for="">Signature du responsable</label>
                <img [src]="initForm.get('urlSignatureResponsable')?.value" alt="" class="w-1/2 h-auto">
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="flex justify-center gap-4 mt-4">
        <button mat-raised-button class="submit-buttonRed" type="button">
          <span class="textForm">Annuler</span>
        </button>
        <button mat-raised-button class="submit-button" aria-label="VALIDER" type="button" (click)="addEntente()">
          <span class="textForm">Ajouter</span>
        </button>
      </div>
    </mat-step>




  </form>
</mat-stepper>
