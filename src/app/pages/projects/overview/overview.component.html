<div class="container-fluid project-detail-container">
  <!-- Titre de la page -->
  <app-page-title title="Détail du projet" [breadcrumbItems]="breadCrumbItems"></app-page-title>

  <div class="row">
    <!-- Colonne principale -->
    <div class="col-lg-8">
      <div class="project-card">
        <div class="card-body">
          <!-- En-tête du projet -->
          <div class="project-header">
            <div class="project-logo">
              <img [src]="DetailProject?.imageUrl ? DetailProject.imageUrl : 'assets/images/project-default.png'"
                alt="Logo du projet" class="project-avatar">
            </div>
            <div class="project-info">
              <h1 class="project-title">{{DetailProject.libelle}}</h1>
              <div class="project-status">
                <span class="status-label">État :</span>
                <span class="status-badge" [ngClass]="getStatusClass(DetailProject.status)">
                  {{DetailProject.status}}
                </span>
              </div>
            </div>
          </div>

          <!-- Description du projet -->
          <div class="project-description">
            <h2 class="section-title">
              <mat-icon>description</mat-icon> Détails du projet
            </h2>
            <p class="description-text">{{DetailProject.description}}</p>
          </div>

          <!-- Dates du projet -->
          <div class="project-dates">
            <div class="date-item">
              <div class="date-icon">
                <mat-icon>event_available</mat-icon>
              </div>
              <div>
                <h3 class="date-label">Date de début</h3>
                <p class="date-value">{{DetailProject.datedebut | date:'dd/MM/yyyy'}}</p>
              </div>
            </div>
            <div class="date-item">
              <div class="date-icon">
                <mat-icon>event_busy</mat-icon>
              </div>
              <div>
                <h3 class="date-label">Date de fin</h3>
                <p class="date-value">{{DetailProject.datefin | date:'dd/MM/yyyy'}}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Colonne latérale - Personnes affectées -->
    <div class="col-lg-4">
      <div class="team-card">
        <div class="card-body">
          <h2 class="section-title">
            <mat-icon>people</mat-icon> Personnes Affectées
          </h2>

          <!-- <div class="team-list">
            @for (item of DetailProject.users; track $index) {
            <div class="team-member">
              <div class="member-avatar">
                <img [src]="item.imageUrl || 'assets/images/users/avatar-default.png'"
                     class="avatar-img" alt="{{item.lastname}}">
              </div>
              <div class="member-info">
                <h3 class="member-name">{{item.lastname}}</h3>
                <p class="member-role">{{item.role || 'Membre'}}</p>
              </div>
            </div>
            }
          </div> -->
          <div class="space-y-3">
            @for (item of  DetailProject.users; track $index) {
            <div class="flex items-center p-3 hover:bg-gray-50 rounded-lg transition">
              <div class="relative">
                @if (item.image) {
                <img [src]="getImageFromBase64(item.image.type, item.image.image)"
                  class="w-10 h-10 rounded-full object-cover border-2 border-[#D45C00]">
                } @else {
                <div
                  class="w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center border-2 border-[#D45C00]">
                  <span class="text-gray-600 font-medium">{{item.lastname | slice:0:1}}</span>
                </div>
                }
                <div class="absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white"></div>
              </div>
              <div class="ml-3">
                <h4 class="text-sm font-medium text-gray-900">{{item.lastname}} {{item.firstname}}</h4>
                <p class="text-xs text-gray-500">{{item.contact || 'Non spécifié'}}</p>
              </div>
            </div>
            } @empty {
            <div class="text-center py-4 text-gray-500">
              <mat-icon class="text-gray-400">group_off</mat-icon>
              <p>Aucune personne assignée</p>
            </div>
            }
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Normes du projet -->
  <div class="row">
    <div class="col-lg-12">
      <div class="standards-card">
        <div class="card-body">
          <h2 class="section-title">
            <mat-icon>rule</mat-icon> Normes du projet
          </h2>

          <div class="standards-list">
            @for (item of DetailProject.normes; track $index) {
            <div class="standard-item">
              <div class="standard-icon">
                <mat-icon>check_circle</mat-icon>
              </div>
              <div class="standard-content">
                <h3 class="standard-title">{{item.titre}}</h3>
                <p class="standard-description">{{item.description}}</p>
              </div>
            </div>
            }
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
