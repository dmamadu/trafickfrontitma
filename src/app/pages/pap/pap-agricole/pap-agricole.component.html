<div>
  <app-page-title title="Liste des Pap Agricoles affectÃ©es par le projet"
    [breadcrumbItems]="breadCrumbItems"></app-page-title>
</div>
<div class=" row mb-2">
  <div class="col-sm">
    <div class="search-box me-2 d-inline-block">
      <div class="position-relative">
        <input type="text" class="form-control" autocomplete="off" id="searchTableList" placeholder="Search..."
          (change)="filterTable($event)">
        <i class="bx bx-search-alt search-icon"></i>
      </div>
    </div>
  </div>
  <div class="col-sm-auto">
    <div class="d-flex flex-wrap gap-2">

      <!-- <button (click)="exportAs('pdf')"> <img src="assets/images/pdf-icon.png" alt="default image"
          class="c_icon"></button>
          <button (click)="exportAs('excel')">
            <img src="assets/images/xlsx-icon.png" alt="default image" class="c_icon">
          </button> -->
      <button type="submit" class="btn bgPrimaire" (click)="addItems()"> <i class="mdi mdi-plus me-1"></i> Ajouter un
        pap agricole</button>

      <button type="submit" class="btn bgPrimaire" (click)="triggerFileUpload()"> <i
          class="mdi mdi-file-excel me-1">Importer un fichier excel</i>
      </button>
    </div>
    <input type="file" id="file-upload" (change)="fileUpload($event)" name="fileUpload" accept=".xls,.xlsx"
      style="display: none;">
  </div>
</div>
@if (dataExcel.length > 0) {
<app-datatable [headings]="headings" [dataExcel]="dataExcel" #dataTable></app-datatable>

<div class="row mt-4">
  <div class="col-lg-12">
    <!-- Affichage des erreurs si besoin -->
    @if (dataTable.hasErrors()) {
    <div class="mb-3 text-sm text-red-600 text-end">
      Veuillez corriger les erreurs pour pouvoir importer
    </div>
    }
    <div class="flex justify-end gap-3">
      <button type="button" class="btn btn-danger w-36" (click)="resetDataFromExcel()">
        Annuler
      </button>
      <button type="submit" class="btn btn-success w-36" [disabled]="dataTable.hasErrors()"
        [class.opacity-50]="dataTable.hasErrors()" [class.cursor-not-allowed]="dataTable.hasErrors()"
        (click)="importData()">
        Importer
      </button>
    </div>
  </div>
</div>
}
<app-loader-data *ngIf="loadData"></app-loader-data>
<div style="z-index: 0" class="pt-3">
  <tableau [pageIndex]="pageIndex" [pageSizeOptions]="pageSizeOptions" [pageSize]="pageSize" [total]="length"
    [coleurEntete]="headers" [entete]="headers" [data]="datas" [actions]="btnActions" (changePage)="pageChanged($event)"
    *ngIf="!loadData"></tableau>
</div>
